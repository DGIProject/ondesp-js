<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Tracer avec canvas</title>

    <link type="text/css" href="css/style.css" rel="stylesheet">

    <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/dragOn.src.js"></script>
    <script>
        var tableauPosition = [];
        function clicCanevas(event) {
            var x = event.pageX - $('#canevas').offset().left;
            var y = event.pageY - $('#canevas').offset().top;
            var pos = [];
            pos.push(x, y);

            tracePoint(event.data, x, y, pos);
        }
        function tracePoint(ctx, x, y, posTab) {

            var lenght = tableauPosition.length, lenth2;
            lenth2 = lenght - 1;
            if (lenght == 0 || posTab[0] > tableauPosition[lenth2][0]) {
                ctx.fillStyle = "#000"
                ctx.fillRect(x, y, 5, 5);
                tableauPosition.push(posTab);
            }
            else {

            }
        }
    </script>
</head>
<body>
<div id="container">
    <div id="dragBox1" class="dragBox" style="width: 500px; height: 500px; position: absolute; z-index: 4;"><canvas id="canvas" style="width: 400px; height: 400px;"></canvas></div>
</div>
<script>
    dragOn.apply(document.getElementById("dragBox1"), {
        moveArea: document.getElementById("container")
    });

    var canvas = $("#canvas");
    var ctx = canvas[0].getContext("2d");
    canvas.on("click", ctx, function (event) {
        $(this).on('mousemove', event.data, clicCanevas);
        $(this).on('click',
                function () {
                    $(this).off('mousemove');
                })
    });
    //canvas.on('mousemove',ctx,clicCanevas);

</script>
</body>
</html>